{% load dict_extras %}

<!DOCTYPE html>
<html>
<head>
    <title>Provider Calendar</title>
    <style>
        table { 
            width: 90%; 
            border-collapse: collapse; 
            font-family: Arial; 
            margin-top: 20px;
        }
        th, td {
            border: 1px solid gray;
            padding: 10px;
            text-align: center;
            height: 80px;
        }
        .today {
            background-color: #c8e6c9;
            font-weight: bold;
        }
        .has-appointments {
            background-color: #fff9c4;
        }
        a {
            text-decoration: none;
            color: #000;
        }
    </style>
</head>
<body style="margin:0;padding:0;">

{% include "accounts/provider_header.html" %}

<div style="padding:20px;">

<h2>{{ month_name }} {{ year }}</h2>

<!-- Month Navigation -->
<a href="?month={{ month|add:"-1" }}&year={{ year }}">⬅ Previous Month</a>
 &nbsp; | &nbsp;
<a href="?month={{ month|add:"1" }}&year={{ year }}">Next Month ➡</a>

<table>
    <tr>
        <th>Mon</th><th>Tue</th><th>Wed</th>
        <th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
    </tr>

    {% for week in month_days %}
    <tr>
        {% for day in week %}
            {% if day == 0 %}
                <td></td>
            {% else %}
                {% with day_str=day|stringformat:"s" %}
                    
                    {% if today.day == day and today.month == month and today.year == year %}
                        <td class="today">
                    {% elif appointment_map|get_item:day_str %}
                        <td class="has-appointments">
                    {% else %}
                        <td>
                    {% endif %}

                    <a href="{% url 'provider_calendar_day' year month day %}">
                        {{ day }}
                    </a>

                    {% if appointment_map|get_item:day_str %}
                        <br>
                        <small>{{ appointment_map|get_item:day_str|length }} appt(s)</small>
                    {% endif %}

                </td>
                {% endwith %}
            {% endif %}
        {% endfor %}
    </tr>
    {% endfor %}
</table>

</div>

</body>
</html>
